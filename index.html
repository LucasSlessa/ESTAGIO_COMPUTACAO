<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de M√©dia M√≥vel e Ajuste Sazonal</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
    
    <div class="container">

        <div class="calendar-container">
            <p>Calend√°rio</p>
            <input type="date" id="calendar" readonly>
        </div>
        

        <div class="card">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Universidade_do_Vale_do_Para%C3%ADba_logo.png/1200px-Universidade_do_Vale_do_Para%C3%ADba_logo.png" alt="">
           
            
            <div class="method-selection">
                <div class="radio-group">
                    <input type="radio" id="simples" name="metodo" value="simples" checked onchange="toggleWeights()">
                    <label for="simples">M√©dia M√≥vel Simples</label>
                </div>
                <div class="radio-group">
                    <input type="radio" id="ponderada" name="metodo" value="ponderada" onchange="toggleWeights()">
                    <label for="ponderada">M√©dia M√≥vel Ponderada</label>
                </div>
            </div>
            
            <div class="controls">
                <input type="number" id="periodos" placeholder="N√∫mero de per√≠odos" min="1" onchange="updateWeights()">
                <button onclick="adicionarLinha()">Adicionar Per√≠odo</button>
                <button onclick="calcularMediaMovel()">Calcular M√©dia M√≥vel</button>
                <button onclick="limparDados()">Limpar Dados</button>
                <button onclick="calcularSazonalidade()">Calcular Ajuste Sazonal</button>

            </div>

            <div id="weightsContainer" class="weights-container">
                <h3>Pesos dos per√≠odos (do mais recente para o mais antigo):</h3>
                <div id="weightInputs"></div>
            </div>

            <div class="table-container">
                <table id="dadosTabela">
                    <thead>
                        <tr>
                            <th>Per√≠odo</th>
                            <th>Valor</th>
                            <th>M√©dia M√≥vel</th>
                            <th>Ajuste Sazonal</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="chart-container">
                <canvas id="grafico"></canvas>
            </div>
            

            <div class="controls">

                <button onclick="exportarParaPDF()">Exportar para PDF</button>
                <button onclick="exportarParaExcel()">Exportar para Excel</button>

            </div>
        </div>
    </div>

   
</body>
</html>
